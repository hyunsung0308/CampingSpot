<!DOCTYPE html>
<html>
<head>
<meta charset="EUC-KR">
<title>Insert title here</title>
<style type="text/css">
ul{
	overflow: hidden;
}
li{
	list-style: none;
	padding: 3px;
	cursor: pointer;
}
</style>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script type="text/javascript">
$(function(){
	var memberId = "test1234";
	var loginData = {"mc_id":memberId}
	// test1234가 로그인했다고 치고
	var price = 140000;
	// 총 숙박비가 140000이라고 치고
	
	
	// 회원의 포인트 불러오기
	$.ajax("/selPoint",{data:loginData,success:function(re){
		//alert(re);
		$("#point").append(re);
		$("#price").append(price);
		
		//point에 붙여주기
		$("#applyPoint").click(function(){
			var putPoint = $("#putPoint").val();
			//사용할 포인트 입력한 값
			$("#uesPoint").append(putPoint);
			//입력한 값 '포인트사용'에 뿌려주기
			$("#totla_price").append(price - putPoint);
			//결제할 총 가격(가격-사용할포인트)	
		});
	}});
	
	
	$("#finalPay").click(function(){
		//누르면  cr_no, 체크인체크아웃날짜 전달해줘서 반환값이 0이나오면 예약가능 1이상나오면 예약불가능
		//if(r == 0 ){ 예약하는(insert)하게 전달해준다
		//if( r > 0) 예약이 불가능합니다 alert띄워주기
		
		// ===> 예약이 가능하다면...
		
		//라디오 버튼이 눌려진 처리에 따라
		var r_payment = $('input[name=r_payment]:checked').val();
		
		//라디오버튼 무통장입금을 눌렀을때
		//무통장입금 정보 페이지로 넘어가기
		if(r_payment == '무통장입금'){
			location.href = "payMu.html";
		}
		//라디오버튼 카드결제를 눌렀을때
		//카드결제 API
		if(r_payment == '카드결제'){
			location.href = "payCard.html";
		}
		
	});
	
});
</script>
</head>
<body>
	<h2>결제하기</h2>
	<hr>
	<span>보유포인트: <span id="point"></span>원</span><input type="number" id="putPoint"></input><button id="applyPoint">적용하기</button><br><br><hr>
	<!-- 로그인한 아이디가 가지고 있는 포인트 id="totalPoint"에먼저 뿌려준다음 가격 입력하고 적용하기 누르면 총 가격-포인트=결제할금액 알려준다 -->
	
	<h4 id="total_price">결제할 금액:</h4>
	<span id="price">총가격: </span><br>
	<span id="uesPoint">포인트 사용: </span><br><hr>
	
	<ul>
		<li>
			<input type="radio" name="r_payment" value="무통장입금">
			<label for="무통장입금">무통장입금</label><br>
		</li>
		<li>
			<input type="radio" name="r_payment" value="카드결제">
			<label for="카드결제">카드결제</label><br>
		</li>
	</ul>
	<button id="finalPay">결제하기</button>
	<!-- 결제하기 누르면 먼저 예약이가능한지 체크한 후에 reservation에 insert한다 -->
</body>
</html>